{"code":"!function(t){var i={};function e(n){if(i[n])return i[n].exports;var a=i[n]={i:n,l:!1,exports:{}};return t[n].call(a.exports,a,a.exports,e),a.l=!0,a.exports}e.m=t,e.c=i,e.d=function(t,i,n){e.o(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:n})},e.r=function(t){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(t,\"__esModule\",{value:!0})},e.t=function(t,i){if(1&i&&(t=e(t)),8&i)return t;if(4&i&&\"object\"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(e.r(n),Object.defineProperty(n,\"default\",{enumerable:!0,value:t}),2&i&&\"string\"!=typeof t)for(var a in t)e.d(n,a,function(i){return t[i]}.bind(null,a));return n},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,\"a\",i),i},e.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},e.p=\"\",e(e.s=4)}([function(t,i,e){var n=e(1),a=e(2);\"string\"==typeof(a=a.__esModule?a.default:a)&&(a=[[t.i,a,\"\"]]);var s={insert:\"head\",singleton:!1};n(a,s);t.exports=a.locals||{}},function(t,i,e){\"use strict\";var n,a=function(){return void 0===n&&(n=Boolean(window&&document&&document.all&&!window.atob)),n},s=function(){var t={};return function(i){if(void 0===t[i]){var e=document.querySelector(i);if(window.HTMLIFrameElement&&e instanceof window.HTMLIFrameElement)try{e=e.contentDocument.head}catch(t){e=null}t[i]=e}return t[i]}}(),o=[];function h(t){for(var i=-1,e=0;e<o.length;e++)if(o[e].identifier===t){i=e;break}return i}function r(t,i){for(var e={},n=[],a=0;a<t.length;a++){var s=t[a],r=i.base?s[0]+i.base:s[0],d=e[r]||0,c=\"\".concat(r,\" \").concat(d);e[r]=d+1;var l=h(c),m={css:s[1],media:s[2],sourceMap:s[3]};-1!==l?(o[l].references++,o[l].updater(m)):o.push({identifier:c,updater:g(m,i),references:1}),n.push(c)}return n}function d(t){var i=document.createElement(\"style\"),n=t.attributes||{};if(void 0===n.nonce){var a=e.nc;a&&(n.nonce=a)}if(Object.keys(n).forEach((function(t){i.setAttribute(t,n[t])})),\"function\"==typeof t.insert)t.insert(i);else{var o=s(t.insert||\"head\");if(!o)throw new Error(\"Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.\");o.appendChild(i)}return i}var c,l=(c=[],function(t,i){return c[t]=i,c.filter(Boolean).join(\"\\n\")});function m(t,i,e,n){var a=e?\"\":n.media?\"@media \".concat(n.media,\" {\").concat(n.css,\"}\"):n.css;if(t.styleSheet)t.styleSheet.cssText=l(i,a);else{var s=document.createTextNode(a),o=t.childNodes;o[i]&&t.removeChild(o[i]),o.length?t.insertBefore(s,o[i]):t.appendChild(s)}}function u(t,i,e){var n=e.css,a=e.media,s=e.sourceMap;if(a?t.setAttribute(\"media\",a):t.removeAttribute(\"media\"),s&&btoa&&(n+=\"\\n/*# sourceMappingURL=data:application/json;base64,\".concat(btoa(unescape(encodeURIComponent(JSON.stringify(s)))),\" */\")),t.styleSheet)t.styleSheet.cssText=n;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(n))}}var w=null,p=0;function g(t,i){var e,n,a;if(i.singleton){var s=p++;e=w||(w=d(i)),n=m.bind(null,e,s,!1),a=m.bind(null,e,s,!0)}else e=d(i),n=u.bind(null,e,i),a=function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)};return n(t),function(i){if(i){if(i.css===t.css&&i.media===t.media&&i.sourceMap===t.sourceMap)return;n(t=i)}else a()}}t.exports=function(t,i){(i=i||{}).singleton||\"boolean\"==typeof i.singleton||(i.singleton=a());var e=r(t=t||[],i);return function(t){if(t=t||[],\"[object Array]\"===Object.prototype.toString.call(t)){for(var n=0;n<e.length;n++){var a=h(e[n]);o[a].references--}for(var s=r(t,i),d=0;d<e.length;d++){var c=h(e[d]);0===o[c].references&&(o[c].updater(),o.splice(c,1))}e=s}}}},function(t,i,e){(i=e(3)(!1)).push([t.i,'html, body{\\n    height:100%;\\n    padding:0;\\n    margin:0;\\n}\\n* {\\n    font-family: \"Lucida Console\", Courier, monospace;\\n}\\nbody {\\n\\tpadding: 0;\\n\\tmargin: 0;\\n\\tbackground: black;\\n}\\ncanvas {\\n\\tbackground: #29adff;\\n}\\n.gameover-scoreboard,\\n.gamestart-scoreboard {\\n\\theight: 100%;\\n\\tbackground: transparent;\\n\\tposition: fixed;\\n\\twidth: 100%;\\n\\theight: 100%;\\n  \\tcolor: white;\\n  \\talign-items: center;\\n    justify-content: center;\\n\\tdisplay: none;\\n}\\n.gameover-scoreboard {\\n\\topacity: .6;\\n\\tcolor: #ff004d;\\n\\tbackground: #29adff;\\n}\\n.gameover-scoreboard h1,\\n.gamestart-scoreboard h1 {\\n\\ttext-align: center;\\n}\\n.gameover-scoreboard table,\\n.gamestart-scoreboard table {\\n\\twidth: 100%;\\n}\\n.gameover-scoreboard p {\\n\\ttext-align: center;\\n}\\ntr.selected {\\n\\tfont-weight: bold;\\n\\tanimation: color-change 1s infinite;\\n}\\n@keyframes color-change {\\n  0% { color: #ff004d; }\\n  50% { color: black; }\\n  100% { color: #ff004d; }\\n}\\n\\n.gamestart-scoreboard {\\n    display: flex;\\n}\\n\\n.gamestart-scoreboard label {\\n\\tdisplay: block;\\n}\\ninput {\\n\\tpadding: 5px;\\n\\tbox-sizing : border-box;\\n}\\ninput[type=\"text\"] {\\n\\tmargin-bottom: 10px;\\n}\\ninput[type=\"submit\"] {\\n\\tbackground: #ff004d;\\n\\tborder: 1px solid #ff004d;\\n\\tcolor: white;\\n\\tpadding: 10px 0px;\\n\\tfont-size: 1.2em;\\n}\\n.gameover-scoreboard img {\\n\\tmargin: auto;\\n}',\"\"]),t.exports=i},function(t,i,e){\"use strict\";t.exports=function(t){var i=[];return i.toString=function(){return this.map((function(i){var e=function(t,i){var e=t[1]||\"\",n=t[3];if(!n)return e;if(i&&\"function\"==typeof btoa){var a=(o=n,h=btoa(unescape(encodeURIComponent(JSON.stringify(o)))),r=\"sourceMappingURL=data:application/json;charset=utf-8;base64,\".concat(h),\"/*# \".concat(r,\" */\")),s=n.sources.map((function(t){return\"/*# sourceURL=\".concat(n.sourceRoot||\"\").concat(t,\" */\")}));return[e].concat(s).concat([a]).join(\"\\n\")}var o,h,r;return[e].join(\"\\n\")}(i,t);return i[2]?\"@media \".concat(i[2],\" {\").concat(e,\"}\"):e})).join(\"\")},i.i=function(t,e,n){\"string\"==typeof t&&(t=[[null,t,\"\"]]);var a={};if(n)for(var s=0;s<this.length;s++){var o=this[s][0];null!=o&&(a[o]=!0)}for(var h=0;h<t.length;h++){var r=[].concat(t[h]);n&&a[r[0]]||(e&&(r[2]?r[2]=\"\".concat(e,\" and \").concat(r[2]):r[2]=e),i.push(r))}},i}},function(t,i,e){\"use strict\";e.r(i);e(0);var n=e.p+\"ebf1f7255206439f2bc85b548cf7f4e0.png\";class a{constructor(t,i=!0){this.sound=document.createElement(\"audio\"),this.sound.src=t,this.sound.loop=i,this.sound.setAttribute(\"preload\",\"auto\"),this.sound.setAttribute(\"controls\",\"none\"),this.sound.style.display=\"none\",document.body.appendChild(this.sound),this.play=function(){this.sound.play()},this.stop=function(){this.sound.pause()}}}class s{constructor(t){this.speed=1,this.image=t,this.width=window.UFO45.tileSize,this.height=window.UFO45.tileSize,this.currentAnimationFrame=0,this.animationFrameCount=0,this.animationFrameCountThreshold=100,this.animationFrames=[{x:4,y:0},{x:5,y:0},{x:6,y:0},{x:7,y:0},{x:4,y:1},{x:5,y:1},{x:6,y:1},{x:7,y:1},{x:4,y:2},{x:5,y:2},{x:6,y:2},{x:7,y:2}],this.x=Math.ceil(window.UFO45.canvas.width/2-this.width/2),this.y=Math.ceil(window.UFO45.canvas.height/2-this.height/2),this.vector=[{x:0,y:0},{x:0,y:0}],window.UFO45.canvas.addEventListener(\"touchstart\",t=>{window.UFO45.gameStarted&&this.soundEffect.play(),this.ray.abducting=!0,this.ray.currentAnimationFrame=0,this.animationFrameCountThreshold=10}),window.UFO45.canvas.addEventListener(\"touchmove\",t=>{t.preventDefault(),this.vector[0].x=this.vector[1].x==t.touches[0].clientX?0:this.vector[1].x<t.touches[0].clientX?-1:1,this.vector[0].y=this.vector[1].y==t.touches[0].clientY?0:this.vector[1].y<t.touches[0].clientY?1:-1,this.vector[1].x=t.touches[0].clientX,this.vector[1].y=t.touches[0].clientY}),window.UFO45.canvas.addEventListener(\"touchend\",t=>{this.soundEffect.stop(),this.ray.abducting=!1,this.animationFrameCountThreshold=100}),this.soundEffect=new a(\"./../media/weird.mp3\"),this.soundEffect.sound.volume=.3,this.crashSoundEffect=new a(\"./../media/crashbit.wav\",!1),this.crashSoundEffect.sound.volume=1,this.ray=new o(t,this.x,this.y)}update(t){window.UFO45.context.drawImage(this.image,this.animationFrames[this.currentAnimationFrame].x*this.width,this.animationFrames[this.currentAnimationFrame].y*this.height,this.width,this.height,this.x,this.y,this.width,this.height),this.animatePlayer(t),this.move(t),this.updatePlayersCollisionBox(t),this.canvasCollisionDetection(),this.ray.update(t)}animatePlayer(t){this.animationFrameCount+=1*t,this.animationFrameCount<this.animationFrameCountThreshold||(this.animationFrameCount=0,this.currentAnimationFrame++,this.currentAnimationFrame>=this.animationFrames.length&&(this.currentAnimationFrame=0))}move(t){window.UFO45.gameStarted&&(this.x+=this.vector[0].x*this.speed,this.y-=this.vector[0].y*this.speed)}updatePlayersCollisionBox(t){switch(window.UFO45.tileSize){case 48:this.collisionBox={x:this.x+8,y:this.y+2,width:this.width-16,height:this.height-3}}window.UFO45.debug&&(window.UFO45.context.strokeStyle=\"blue\",window.UFO45.context.beginPath(),window.UFO45.context.rect(this.collisionBox.x,this.collisionBox.y,this.collisionBox.width,this.collisionBox.height),window.UFO45.context.stroke())}canvasCollisionDetection(){this.x+this.width>=window.UFO45.canvas.width&&(this.x=Math.ceil(window.UFO45.canvas.width-this.width)),this.x<0&&(this.x=0),this.y+this.height>window.UFO45.canvas.height-window.UFO45.foreground.height&&(window.UFO45.gameOver=!0),this.y<0&&(this.y=0)}}class o{constructor(t,i,e){this.x=i,this.y=e,this.width=window.UFO45.tileSize,this.height=window.UFO45.tileSize,this.image=t,this.abducting=!1,this.currentAnimationFrame=0,this.animationFrameCount=0,this.animationFrameCountThreshold=100,this.animationFrames=[{x:4,y:6},{x:5,y:6},{x:6,y:6},{x:3,y:7},{x:4,y:7},{x:5,y:7},{x:6,y:7},{x:7,y:7}]}update(t){this.x=window.UFO45.player.x,this.y=window.UFO45.player.y+window.UFO45.player.height,this.abducting&&window.UFO45.abducteeFactory.abductee.beingAbducted&&(window.UFO45.context.drawImage(this.image,this.animationFrames[this.currentAnimationFrame].x*this.width,this.animationFrames[this.currentAnimationFrame].y*this.height,this.width,this.height,this.x,this.y,this.width,this.height),this.animate(t))}animate(t){this.animationFrameCount+=1*t,this.animationFrameCount<this.animationFrameCountThreshold||(this.animationFrameCount=0,this.currentAnimationFrame++,this.currentAnimationFrame>=this.animationFrames.length&&(this.currentAnimationFrame=0))}}class h{constructor(t){this.speed=1,this.image=t,this.width=window.UFO45.tileSize,this.height=window.UFO45.tileSize,this.x=0,this.y=window.UFO45.canvas.height-this.width,this.numberOfTiles=Math.ceil(window.UFO45.canvas.width/window.UFO45.tileSize),this.animationFrameCount=0,this.animationFrameCountThreshold=20}update(t){for(let t=-1;t<this.numberOfTiles+1;t++)window.UFO45.context.drawImage(this.image,1*this.width,0*this.height,this.width,this.height,this.x+t*this.width,this.y,this.width,this.height);this.updateAnimationThreshold(),this.animate(t)}updateAnimationThreshold(){window.UFO45.player.x<window.UFO45.player.vecX?this.animationFrameCountThreshold=10:this.animationFrameCountThreshold=20}animate(t){this.animationFrameCount+=1*t,this.animationFrameCount<this.animationFrameCountThreshold||(this.animationFrameCount=0,this.x++,(this.x>this.width||this.x<-this.width)&&(this.x=0))}}class r{constructor(){this.font=\"18px monaco, monospace\",this.color=\"black\",this.x=10,this.y=30,this.score=0,window.UFO45.context.font=this.font}update(t){window.UFO45.gameStarted&&!window.UFO45.gameOver&&(this.score+=1*t/1e3),window.UFO45.context.fillStyle=this.color,window.UFO45.context.fillText(\"Score \"+Math.floor(this.score),this.x,this.y)}}function d(t,i){return t=Math.ceil(t),i=Math.floor(i),Math.floor(Math.random()*(i-t))+t}function c(t,i){return!(t.y+t.height<i.y||t.y>i.y+i.height||t.x+t.width<i.x||t.x>i.x+i.width)}class l{constructor(t,i){this.speed=2,this.image=t,this.width=2*window.UFO45.tileSize,this.height=window.UFO45.tileSize,this.x=i,this.y=window.UFO45.canvas.height-2*this.height}update(){window.UFO45.player.vector[0].x>0?this.speed=3:this.speed=2,window.UFO45.context.drawImage(this.image,5*window.UFO45.tileSize,5*window.UFO45.tileSize,this.width,this.height,this.x,this.y,this.width,this.height),this.x-=this.speed,this.x<-this.width&&(this.x=d(window.UFO45.canvas.width,2*window.UFO45.canvas.width))}}class m{constructor(t){this.image=t,this.topNumberOfEnemies=Math.ceil((window.UFO45.canvas.height-3*window.UFO45.tileSize)/window.UFO45.tileSize)*Math.ceil(window.UFO45.canvas.width/window.UFO45.tileSize)/4,this.secondsUntilNextEnemy=Math.ceil(200/this.topNumberOfEnemies),this.enemies=[],this.enemies.push(new u(t,0))}update(t){const i=Math.floor(window.UFO45.score.score);i%this.secondsUntilNextEnemy==0&&this.enemies.length<=i/this.secondsUntilNextEnemy&&this.enemies.length<=this.topNumberOfEnemies&&this.enemies.push(new u(this.image,this.enemies.length)),this.enemies.forEach(i=>i.update(t))}}class u{constructor(t,i){var e,n;this.speed=1,this.image=t,this.width=window.UFO45.tileSize,this.height=window.UFO45.tileSize,this.currentAnimationFrame=0,this.animationFrameCount=0,this.animationFrameCountThreshold=300,this.animationFrames=[{x:2,y:4},{x:2,y:5},{x:2,y:6},{x:2,y:7},{x:3,y:4},{x:3,y:5},{x:3,y:6}],this.currentAnimation=d(1,10)>6?\"rain\":\"default\",this.globalAlpha=(e=.3,n=.8,Math.round(10*(Math.random()*(n-e)+e))/10),this.randomizeCoordinates(),this.createRainDrops()}randomizeCoordinates(){this.x=d(window.UFO45.canvas.width,2*window.UFO45.canvas.width),this.y=d(0,window.UFO45.canvas.height-3*window.UFO45.tileSize)}createRainDrops(){if(\"rain\"==this.currentAnimation){this.rainDrops=[];for(let t=0;t<this.width;t++)for(let i=0;i<2*this.height;i++)t%5==0&&i%10==0&&this.rainDrops.push(new w(this.x+t,this.y+this.height+i,this))}}update(t){window.UFO45.context.globalAlpha=this.globalAlpha,window.UFO45.context.drawImage(this.image,this.animationFrames[this.currentAnimationFrame].x*this.width,this.animationFrames[this.currentAnimationFrame].y*this.height,this.width,this.height,this.x,this.y,this.width,this.height),window.UFO45.context.globalAlpha=1,this.move(),this.animateCloud(t),this.animateRain(t),this.collisionDetection()}move(){this.x-=this.speed,this.x<-this.width&&(this.currentAnimation=d(1,10)>6?\"rain\":\"default\",this.currentAnimationFrame=0,this.randomizeCoordinates(),this.createRainDrops())}animateCloud(t){if(\"rain\"==this.currentAnimation){if(this.animationFrameCount+=1*t,this.animationFrameCount<this.animationFrameCountThreshold)return;this.animationFrameCount=0,this.currentAnimationFrame++,this.currentAnimationFrame>=this.animationFrames.length&&(this.currentAnimationFrame=0)}}animateRain(t){\"rain\"==this.currentAnimation&&this.rainDrops.forEach(t=>t.update())}collisionDetection(){switch(window.UFO45.tileSize){case 48:this.collisionBox={x:this.x+5,y:this.y+16,width:this.width-8,height:this.height-29},this.collisionBox.height=\"rain\"==this.currentAnimation?this.collisionBox.height+this.height+10:this.collisionBox.height}window.UFO45.debug&&(window.UFO45.context.strokeStyle=\"red\",window.UFO45.context.beginPath(),window.UFO45.context.rect(this.collisionBox.x,this.collisionBox.y,this.collisionBox.width,this.collisionBox.height),window.UFO45.context.stroke()),c(this.collisionBox,window.UFO45.player.collisionBox)&&(window.UFO45.gameOver=!0)}}class w{constructor(t,i,e){this.width=2,this.height=2,this.x=t,this.y=i,this.cloud=e}update(){window.UFO45.context.fillStyle=\"#94cff4\",window.UFO45.context.fillRect(this.x,this.y,this.width,this.height),this.x-=this.cloud.speed,this.y++,this.y>this.cloud.y+2*this.cloud.height&&(this.y=this.cloud.y+this.cloud.height-this.cloud.height/4),this.x,this.width}}function p(t){for(var i=t+\"=\",e=decodeURIComponent(document.cookie).split(\";\"),n=0;n<e.length;n++){for(var a=e[n];\" \"==a.charAt(0);)a=a.substring(1);if(0==a.indexOf(i))return a.substring(i.length,a.length)}return\"\"}class g{constructor(){window.UFO45.player.soundEffect.stop(),window.UFO45.player.crashSoundEffect.play(),window.UFO45.soundTrack.stop()}writeScore(){this.gameoverScoreboard=document.querySelector(\".gameover-scoreboard\"),this.gameoverScoreboard.style.display=\"flex\",this.gameoverScoreboard.addEventListener(\"touchstart\",()=>{location.reload()}),this.updateScore()}updateScore(){const t=parseInt(p(\"playerId\"));fetch(`get-scores.php?playerScore=${parseInt(window.UFO45.score.score)}&playerId=${t}`).then(t=>t.json()).then(t=>{let i=this.gameoverScoreboard.querySelector(\"tbody\"),e=parseInt(p(\"playerId\"));i.innerHTML=\"\",t.forEach(t=>{let n=document.createElement(\"tr\"),a=document.createElement(\"td\"),s=document.createElement(\"td\"),o=document.createElement(\"td\");a.innerHTML=t.rank,s.innerHTML=t.name,o.innerHTML=t.score,t.id===e&&n.classList.add(\"selected\"),n.appendChild(a),n.appendChild(s),n.appendChild(o),i.appendChild(n)})})}}class F{constructor(){this.gamestartScoreboard=document.querySelector(\".gamestart-scoreboard\"),this.nameField=this.gamestartScoreboard.querySelector('input[type=\"text\"]'),this.submitButton=this.gamestartScoreboard.querySelector('input[type=\"submit\"]'),this.fillTopPlayers(),this.fillUserName(),this.submitButton.onclick=()=>{this.playerNameEventListener()}}fillUserName(){const t=p(\"playerName\");t&&(this.nameField.value=t)}fillTopPlayers(){fetch(\"get-top-players.php\").then(t=>t.json()).then(t=>{let i=this.gamestartScoreboard.querySelector(\"tbody\");i.innerHTML=\"\",t.forEach((t,e)=>{let n=document.createElement(\"tr\"),a=document.createElement(\"td\"),s=document.createElement(\"td\"),o=document.createElement(\"td\");a.innerHTML=e+1,s.innerHTML=t.name,o.innerHTML=t.score;const h=parseInt(p(\"playerId\"));parseInt(t.id)===h&&n.classList.add(\"selected\"),n.appendChild(a),n.appendChild(s),n.appendChild(o),i.appendChild(n)})})}playerNameEventListener(){const t=parseInt(p(\"playerId\")),i=this.gamestartScoreboard.querySelector('input[type=\"text\"]');if(i.value||(i.value=\"Anonymous\"),i.value===p(\"playerName\")&&!isNaN(parseInt(p(\"playerId\"))))return this.startGame();const e=new FormData;e.append(\"playerId\",!isNaN(t)&&t),e.append(\"playerName\",i.value),fetch(\"submit-player-name.php\",{method:\"POST\",body:e}).then(t=>t.json()).then(t=>{this.startGame()})}startGame(){this.gamestartScoreboard.style.display=\"none\",window.UFO45.startGame()}}class y{constructor(t,i){this.image=t,this.width=window.UFO45.tileSize,this.height=2*window.UFO45.tileSize,this.x=i,this.y=window.UFO45.canvas.height-this.height-window.UFO45.tileSize,this.currentAnimationFrame=0,this.animationFrameCount=0,this.animationFrameCountThreshold=100,this.animationFrames=[{x:4,y:3},{x:5,y:3},{x:6,y:3},{x:7,y:3}]}update(t){window.UFO45.context.drawImage(this.image,this.animationFrames[this.currentAnimationFrame].x*this.width,this.animationFrames[this.currentAnimationFrame].y*window.UFO45.tileSize,this.width,this.height,this.x,this.y,this.width,this.height),this.x--,this.animate(t)}animate(t){this.animationFrameCount+=1*t,this.animationFrameCount<this.animationFrameCountThreshold||(this.animationFrameCount=0,this.currentAnimationFrame++,this.currentAnimationFrame>=this.animationFrames.length&&(this.currentAnimationFrame=0))}}class f{constructor(t,i){this.image=t,this.width=2*window.UFO45.tileSize,this.height=window.UFO45.tileSize,this.x=i,this.y=window.UFO45.canvas.height-this.height-window.UFO45.tileSize,this.currentAnimationFrame=0,this.animationFrameCount=0,this.animationFrameCountThreshold=100,this.animationFrames=[{x:0,y:4},{x:0,y:5},{x:0,y:6},{x:0,y:7}],this.speedAnimationFrameCount=0,this.speedAnimationFrameCountThreshold=50,this.beingAbducted=!1,this.abductedResistance=100,this.direction=1}update(t){window.UFO45.context.drawImage(this.image,this.animationFrames[this.currentAnimationFrame].x*this.width,this.animationFrames[this.currentAnimationFrame].y*window.UFO45.tileSize,this.width,this.height,this.x,this.y,this.width,this.height),this.animate(t),this.move(t),this.collisionDetection(t)}animate(t){this.animationFrameCount+=1*t,this.animationFrameCount<this.animationFrameCountThreshold||(this.animationFrameCount=0,this.currentAnimationFrame++,this.currentAnimationFrame>=this.animationFrames.length&&(this.currentAnimationFrame=0))}move(t){this.abductedResistance<0&&(this.y--,this.x+=this.direction,this.x+this.width>window.UFO45.canvas.width&&(this.direction*=-1)),this.speedAnimationFrameCount+=1*t,this.speedAnimationFrameCount<this.speedAnimationFrameCountThreshold||(this.speedAnimationFrameCount=0,this.x--)}collisionDetection(t){switch(window.UFO45.tileSize){case 48:this.collisionBox={x:this.x+10,y:this.y+1,width:this.width-18,height:this.height}}if(window.UFO45.debug&&(window.UFO45.context.strokeStyle=\"red\",window.UFO45.context.beginPath(),window.UFO45.context.rect(this.collisionBox.x,this.collisionBox.y,this.collisionBox.width,this.collisionBox.height),window.UFO45.context.stroke()),c(this.collisionBox,window.UFO45.player.ray)){this.beingAbducted=!0,this.abductedResistance--;let t,i=window.UFO45.context.getImageData(this.collisionBox.x,this.collisionBox.y,this.collisionBox.width,this.collisionBox.height);for(t=0;t<i.data.length;t+=4)i.data[t]=d(0,255)-i.data[t],i.data[t+1]=d(150,255)-i.data[t+1],i.data[t+2]=d(255,255)-i.data[t+2],i.data[t+3]=255;window.UFO45.context.putImageData(i,this.collisionBox.x,this.collisionBox.y)}else this.beingAbducted=!1;this.abductedResistance<0&&window.UFO45.CloudEnemies.enemies.forEach(t=>{c(this.collisionBox,t)&&(t.x=-t.width,this.direction*=-1)})}}class x{constructor(t){this.image=t,this.createRandomAbductee()}createRandomAbductee(){let t=100*Math.random(),i=d(window.UFO45.canvas.width,2*window.UFO45.canvas.width);this.abductee=t<=100?new f(this.image,i):new y(this.image,i)}update(t){this.abductee.update(t),this.abductee.x+this.abductee.width<0&&(delete this.abductee,this.createRandomAbductee())}}class b{constructor(t){this.day=!1,this.canvas=window.UFO45.canvas,this.lastUpdate=0,this.stars=[]}update(t){const i=Math.floor(window.UFO45.score.score);i>1&&i%60==0&&i>this.lastUpdate&&(this.canvas.style.background=this.day?\"#29adff\":\"#1d2b53\",this.day=!this.day,this.lastUpdate=i,this.day||this.createStars()),this.updateStars()}createStars(){}}window.UFO45=new class{constructor(){this.canvas=document.getElementById(\"canvas\"),this.canvas.width=window.innerWidth,this.canvas.height=window.innerHeight,this.context=this.canvas.getContext(\"2d\"),this.tileSize=48,this.gameStarted=!1,this.gameOver=!1,this.debug=!1}init(){let t=new Image;t.src=n,this.soundTrack=new a(\"./../media/soundtrack.mp3\"),this.score=new r,this.Background=new b(t),this.player=new s(t),this.foreground=new h(t),this.CloudEnemies=new m(t),this.abducteeFactory=new x(t),this.bushes=[new l(t,Math.ceil(Math.random()*window.UFO45.canvas.width)),new l(t,Math.ceil(Math.random()*window.UFO45.canvas.width)),new l(t,Math.ceil(Math.random()*window.UFO45.canvas.width))],this.SplashScreen=new F,requestAnimationFrame(t=>this.update(t))}clear(){this.context.clearRect(0,0,this.canvas.width,this.canvas.height)}update(t){const i=t-(this.lastUpdate||0);if(this.lastUpdate=t,this.clear(),this.Background.update(i),this.score.update(i),this.gameStarted&&(this.player.update(i),this.CloudEnemies.update(i)),this.foreground.update(i),this.bushes.forEach(t=>{t.update(i)}),this.abducteeFactory.update(i),this.gameOver)return this.scoreUpdater=new g,this.scoreUpdater.writeScore();requestAnimationFrame(t=>this.update(t))}startGame(){window.UFO45.soundTrack.play(),window.UFO45.gameStarted=!0}},window.onload=function(){window.UFO45.init()}}]);","extractedComments":[]}